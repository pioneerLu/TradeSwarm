# åŸºæœ¬é¢åˆ†ææ¥å£è°ƒæŸ¥æŠ¥å‘Š

## ğŸ“‹ è°ƒæŸ¥ç›®æ ‡
è°ƒæŸ¥ Tushare å’Œ AkShare åœ¨åŸºæœ¬é¢åˆ†ææ–¹é¢çš„å¯ç”¨æ¥å£ï¼Œç¡®å®šä¼˜å…ˆçº§å’Œ fallback ç­–ç•¥ã€‚

## ğŸ” è°ƒæŸ¥ç»“æœæ€»è§ˆ

### æ¥å£æ•°é‡å¯¹æ¯”
- **Tushare**: çº¦ 17 ä¸ªåŸºæœ¬é¢ç›¸å…³æ¥å£
- **AkShare**: çº¦ 454 ä¸ªè‚¡ç¥¨ç›¸å…³æ¥å£ï¼ˆå…¶ä¸­åŸºæœ¬é¢ç›¸å…³çº¦ 50+ ä¸ªï¼‰

### æ€»ä½“ç­–ç•¥
âœ… **ä¼˜å…ˆä½¿ç”¨ AkShareï¼ŒTushare ä½œä¸º Fallback**

---

## ğŸ“Š è¯¦ç»†æ¥å£å¯¹æ¯”

### 1. å…¬å¸åŸºæœ¬ä¿¡æ¯

#### Tushare æ¥å£
- `stock_basic`: è‚¡ç¥¨åŸºæœ¬ä¿¡æ¯ï¼ˆä»£ç ã€åç§°ã€è¡Œä¸šã€ä¸Šå¸‚æ—¥æœŸç­‰ï¼‰
- `stock_company`: ä¸Šå¸‚å…¬å¸åŸºæœ¬ä¿¡æ¯ï¼ˆæ›´è¯¦ç»†ï¼‰

#### AkShare æ¥å£
- `stock_info_a_code_name`: Aè‚¡ä»£ç å’Œåç§°
- `stock_info_sh_name_code`: ä¸Šæµ·è‚¡ç¥¨ä»£ç å’Œåç§°
- `stock_info_sz_name_code`: æ·±åœ³è‚¡ç¥¨ä»£ç å’Œåç§°
- `stock_profile_cninfo`: å…¬å¸æ¦‚å†µï¼ˆå·¨æ½®èµ„è®¯ç½‘ï¼‰
- `stock_individual_info_em`: ä¸ªè‚¡ä¿¡æ¯ï¼ˆä¸œæ–¹è´¢å¯Œï¼‰

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_profile_cninfo` æˆ– `stock_individual_info_em`ï¼ˆä¿¡æ¯æ›´å…¨é¢ï¼‰
2. **Fallback**: `stock_basic`ï¼ˆTushareï¼‰

---

### 2. åˆ©æ¶¦è¡¨æ•°æ®

#### Tushare æ¥å£
- `income`: åˆ©æ¶¦è¡¨æ•°æ®
- `income_vip`: åˆ©æ¶¦è¡¨æ•°æ®ï¼ˆVIPç‰ˆæœ¬ï¼‰

#### AkShare æ¥å£
- `stock_profit_sheet_by_yearly_em`: åˆ©æ¶¦è¡¨ï¼ˆå¹´åº¦ï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_profit_sheet_by_quarterly_em`: åˆ©æ¶¦è¡¨ï¼ˆå­£åº¦ï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_profit_sheet_by_report_em`: åˆ©æ¶¦è¡¨ï¼ˆæŠ¥å‘ŠæœŸï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_lrb_em`: åˆ©æ¶¦è¡¨ï¼ˆä¸œæ–¹è´¢å¯Œï¼Œç®€åŒ–ç‰ˆï¼‰

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_profit_sheet_by_yearly_em` æˆ– `stock_profit_sheet_by_quarterly_em`ï¼ˆæ”¯æŒå¹´åº¦/å­£åº¦ï¼‰
2. **Fallback**: `income`ï¼ˆTushareï¼‰

---

### 3. èµ„äº§è´Ÿå€ºè¡¨æ•°æ®

#### Tushare æ¥å£
- `balancesheet`: èµ„äº§è´Ÿå€ºè¡¨æ•°æ®
- `balancesheet_vip`: èµ„äº§è´Ÿå€ºè¡¨æ•°æ®ï¼ˆVIPç‰ˆæœ¬ï¼‰

#### AkShare æ¥å£
- `stock_balance_sheet_by_yearly_em`: èµ„äº§è´Ÿå€ºè¡¨ï¼ˆå¹´åº¦ï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_balance_sheet_by_report_em`: èµ„äº§è´Ÿå€ºè¡¨ï¼ˆæŠ¥å‘ŠæœŸï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_zcfz_em`: èµ„äº§è´Ÿå€ºè¡¨ï¼ˆä¸œæ–¹è´¢å¯Œï¼Œç®€åŒ–ç‰ˆï¼‰

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_balance_sheet_by_yearly_em`ï¼ˆå¹´åº¦æ•°æ®ï¼‰
2. **Fallback**: `balancesheet`ï¼ˆTushareï¼‰

---

### 4. ç°é‡‘æµé‡è¡¨æ•°æ®

#### Tushare æ¥å£
- `cashflow`: ç°é‡‘æµé‡è¡¨æ•°æ®
- `cashflow_vip`: ç°é‡‘æµé‡è¡¨æ•°æ®ï¼ˆVIPç‰ˆæœ¬ï¼‰

#### AkShare æ¥å£
- `stock_cash_flow_sheet_by_yearly_em`: ç°é‡‘æµé‡è¡¨ï¼ˆå¹´åº¦ï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_cash_flow_sheet_by_quarterly_em`: ç°é‡‘æµé‡è¡¨ï¼ˆå­£åº¦ï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_cash_flow_sheet_by_report_em`: ç°é‡‘æµé‡è¡¨ï¼ˆæŠ¥å‘ŠæœŸï¼Œä¸œæ–¹è´¢å¯Œï¼‰
- `stock_xjll_em`: ç°é‡‘æµé‡è¡¨ï¼ˆä¸œæ–¹è´¢å¯Œï¼Œç®€åŒ–ç‰ˆï¼‰

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_cash_flow_sheet_by_yearly_em` æˆ– `stock_cash_flow_sheet_by_quarterly_em`ï¼ˆæ”¯æŒå¹´åº¦/å­£åº¦ï¼‰
2. **Fallback**: `cashflow`ï¼ˆTushareï¼‰

---

### 5. è´¢åŠ¡æŒ‡æ ‡

#### Tushare æ¥å£
- `fina_indicator`: è´¢åŠ¡æŒ‡æ ‡æ•°æ®ï¼ˆROEã€ROAã€æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡ç­‰ï¼‰
- `fina_indicator_vip`: è´¢åŠ¡æŒ‡æ ‡æ•°æ®ï¼ˆVIPç‰ˆæœ¬ï¼‰

#### AkShare æ¥å£
- `stock_financial_analysis_indicator_em`: è´¢åŠ¡åˆ†ææŒ‡æ ‡ï¼ˆä¸œæ–¹è´¢å¯Œï¼‰
- `stock_financial_analysis_indicator`: è´¢åŠ¡åˆ†ææŒ‡æ ‡ï¼ˆåŒèŠ±é¡ºï¼‰
- `stock_zh_dupont_comparison_em`: æœé‚¦åˆ†æå¯¹æ¯”
- `stock_zh_growth_comparison_em`: æˆé•¿èƒ½åŠ›å¯¹æ¯”
- `stock_zh_scale_comparison_em`: è§„æ¨¡å¯¹æ¯”

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_financial_analysis_indicator_em`ï¼ˆä¸œæ–¹è´¢å¯Œï¼Œæ•°æ®è¾ƒå…¨ï¼‰
2. **Fallback**: `fina_indicator`ï¼ˆTushareï¼‰

---

### 6. ä¼°å€¼æŒ‡æ ‡

#### Tushare æ¥å£
- `daily_basic`: æ¯æ—¥åŸºæœ¬é¢æŒ‡æ ‡ï¼ˆPEã€PBã€PSã€æ€»å¸‚å€¼ã€æµé€šå¸‚å€¼ç­‰ï¼‰
- `adj_factor`: å¤æƒå› å­

#### AkShare æ¥å£
- `stock_a_ttm_lyr`: Aè‚¡TTMå’ŒLYRï¼ˆæ»šåŠ¨å¸‚ç›ˆç‡ã€é™æ€å¸‚ç›ˆç‡ï¼‰
- `stock_a_all_pb`: Aè‚¡PBæ•°æ®
- `stock_market_pe_lg`: å¸‚åœºPEï¼ˆä¹å’•ä¹è‚¡ï¼‰
- `stock_market_pb_lg`: å¸‚åœºPBï¼ˆä¹å’•ä¹è‚¡ï¼‰
- `stock_index_pe_lg`: æŒ‡æ•°PEï¼ˆä¹å’•ä¹è‚¡ï¼‰
- `stock_index_pb_lg`: æŒ‡æ•°PBï¼ˆä¹å’•ä¹è‚¡ï¼‰
- `stock_industry_pe_ratio_cninfo`: è¡Œä¸šPEæ¯”ç‡ï¼ˆå·¨æ½®èµ„è®¯ç½‘ï¼‰
- `stock_dividend_cninfo`: åˆ†çº¢æ•°æ®ï¼ˆå·¨æ½®èµ„è®¯ç½‘ï¼‰
- `stock_history_dividend`: å†å²åˆ†çº¢

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: 
   - PE/PB: `stock_a_ttm_lyr`ï¼ˆå®æ—¶ä¼°å€¼ï¼‰
   - å¸‚åœº/è¡Œä¸šå¯¹æ¯”: `stock_market_pe_lg` / `stock_industry_pe_ratio_cninfo`
   - åˆ†çº¢: `stock_dividend_cninfo`
2. **Fallback**: `daily_basic`ï¼ˆTushareï¼Œæ¯æ—¥æ•°æ®ï¼‰

---

### 7. ä¸šç»©é¢„å‘Š/å¿«æŠ¥

#### Tushare æ¥å£
- `forecast`: ä¸šç»©é¢„å‘Š
- `express`: ä¸šç»©å¿«æŠ¥

#### AkShare æ¥å£
- `stock_profit_forecast_em`: ä¸šç»©é¢„å‘Šï¼ˆä¸œæ–¹è´¢å¯Œï¼‰
- `stock_profit_forecast_ths`: ä¸šç»©é¢„å‘Šï¼ˆåŒèŠ±é¡ºï¼‰
- `stock_yjyg_em`: ä¸šç»©é¢„å‘Šï¼ˆEMï¼‰
- `stock_yjkb_em`: ä¸šç»©å¿«æŠ¥ï¼ˆEMï¼‰
- `stock_yjbb_em`: ä¸šç»©æŠ¥è¡¨ï¼ˆEMï¼‰

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_profit_forecast_em` æˆ– `stock_yjyg_em`ï¼ˆä¸šç»©é¢„å‘Šï¼‰
2. **Fallback**: `forecast`ï¼ˆTushareï¼‰

---

### 8. å…¶ä»–è´¢åŠ¡æ•°æ®

#### Tushare æ¥å£
- `dividend`: åˆ†çº¢é€è‚¡
- `fina_audit`: è´¢åŠ¡å®¡è®¡æ„è§
- `fina_mainbz`: ä¸»è¥ä¸šåŠ¡æ„æˆ

#### AkShare æ¥å£
- `stock_financial_abstract`: è´¢åŠ¡æ‘˜è¦
- `stock_financial_abstract_ths`: è´¢åŠ¡æ‘˜è¦ï¼ˆåŒèŠ±é¡ºï¼‰
- `stock_financial_report_sina`: è´¢åŠ¡æŠ¥å‘Šï¼ˆæ–°æµªï¼‰
- `stock_zh_valuation_comparison_em`: ä¼°å€¼å¯¹æ¯”

#### æ¨èç­–ç•¥
1. **ä¼˜å…ˆ**: `stock_financial_abstract`ï¼ˆè´¢åŠ¡æ‘˜è¦ï¼‰
2. **Fallback**: `dividend`ï¼ˆTushareï¼Œåˆ†çº¢æ•°æ®ï¼‰

---

## ğŸ› ï¸ å·¥å…·è®¾è®¡å»ºè®®

åŸºäºä»¥ä¸Šè°ƒæŸ¥ï¼Œå»ºè®®è®¾è®¡ä»¥ä¸‹ 5 ä¸ªå·¥å…·ï¼š

### 1. `get_company_info`
**åŠŸèƒ½**: è·å–å…¬å¸åŸºæœ¬ä¿¡æ¯ï¼ˆåç§°ã€è¡Œä¸šã€ä¸Šå¸‚æ—¥æœŸã€è‚¡æœ¬ç­‰ï¼‰

**æ¥å£é€‰æ‹©**:
- ä¼˜å…ˆ: `stock_profile_cninfo`ï¼ˆAkShareï¼‰
- Fallback: `stock_basic`ï¼ˆTushareï¼‰

---

### 2. `get_financial_statements`
**åŠŸèƒ½**: è·å–ä¸‰å¤§è´¢åŠ¡æŠ¥è¡¨ï¼ˆåˆ©æ¶¦è¡¨ã€èµ„äº§è´Ÿå€ºè¡¨ã€ç°é‡‘æµé‡è¡¨ï¼‰

**æ¥å£é€‰æ‹©**:
- ä¼˜å…ˆï¼ˆAkShareï¼‰:
  - åˆ©æ¶¦è¡¨: `stock_profit_sheet_by_yearly_em` / `stock_profit_sheet_by_quarterly_em`
  - èµ„äº§è´Ÿå€ºè¡¨: `stock_balance_sheet_by_yearly_em`
  - ç°é‡‘æµé‡è¡¨: `stock_cash_flow_sheet_by_yearly_em`
- Fallbackï¼ˆTushareï¼‰:
  - åˆ©æ¶¦è¡¨: `income`
  - èµ„äº§è´Ÿå€ºè¡¨: `balancesheet`
  - ç°é‡‘æµé‡è¡¨: `cashflow`

**å‚æ•°è®¾è®¡**:
- `ts_code`: è‚¡ç¥¨ä»£ç 
- `report_type`: 'annual'ï¼ˆå¹´åº¦ï¼‰æˆ– 'quarter'ï¼ˆå­£åº¦ï¼‰
- `periods`: è·å–æœ€è¿‘ N æœŸæ•°æ®ï¼ˆé»˜è®¤ 4 æœŸï¼‰

---

### 3. `get_financial_indicators`
**åŠŸèƒ½**: è·å–è´¢åŠ¡æŒ‡æ ‡ï¼ˆROEã€ROAã€æ¯›åˆ©ç‡ã€å‡€åˆ©ç‡ç­‰ï¼‰

**æ¥å£é€‰æ‹©**:
- ä¼˜å…ˆ: `stock_financial_analysis_indicator_em`ï¼ˆAkShareï¼‰
- Fallback: `fina_indicator`ï¼ˆTushareï¼‰

**å‚æ•°è®¾è®¡**:
- `ts_code`: è‚¡ç¥¨ä»£ç 
- `report_type`: 'annual' æˆ– 'quarter'
- `periods`: æœ€è¿‘ N æœŸï¼ˆé»˜è®¤ 4 æœŸï¼‰

---

### 4. `get_valuation_indicators`
**åŠŸèƒ½**: è·å–ä¼°å€¼æŒ‡æ ‡ï¼ˆPEã€PBã€PSã€è‚¡æ¯ç‡ç­‰ï¼‰

**æ¥å£é€‰æ‹©**:
- ä¼˜å…ˆï¼ˆAkShareï¼‰:
  - PE/PB: `stock_a_ttm_lyr`
  - å¸‚åœºPE/PB: `stock_market_pe_lg` / `stock_market_pb_lg`
  - è¡Œä¸šPE: `stock_industry_pe_ratio_cninfo`
  - åˆ†çº¢: `stock_dividend_cninfo`
- Fallbackï¼ˆTushareï¼‰:
  - æ¯æ—¥åŸºæœ¬é¢: `daily_basic`ï¼ˆPEã€PBç­‰ï¼‰

**å‚æ•°è®¾è®¡**:
- `ts_code`: è‚¡ç¥¨ä»£ç 
- `include_market_comparison`: æ˜¯å¦åŒ…å«å¸‚åœº/è¡Œä¸šå¯¹æ¯”ï¼ˆé»˜è®¤ Trueï¼‰

---

### 5. `get_earnings_data`
**åŠŸèƒ½**: è·å–ä¸šç»©é¢„å‘Šã€å¿«æŠ¥æ•°æ®

**æ¥å£é€‰æ‹©**:
- ä¼˜å…ˆï¼ˆAkShareï¼‰:
  - ä¸šç»©é¢„å‘Š: `stock_profit_forecast_em` / `stock_yjyg_em`
  - ä¸šç»©å¿«æŠ¥: `stock_yjkb_em`
- Fallbackï¼ˆTushareï¼‰:
  - ä¸šç»©é¢„å‘Š: `forecast`
  - ä¸šç»©å¿«æŠ¥: `express`

**å‚æ•°è®¾è®¡**:
- `ts_code`: è‚¡ç¥¨ä»£ç 
- `limit`: è¿”å›æœ€è¿‘ N æ¡è®°å½•ï¼ˆé»˜è®¤ 10 æ¡ï¼‰

---

## ğŸ“ å®ç°å»ºè®®

### Provider å±‚æ‰©å±•

#### AkshareProvider æ‰©å±•
åœ¨ `tradingagents/data_sources/akshare_provider.py` ä¸­æ·»åŠ ä»¥ä¸‹ç§æœ‰æ–¹æ³•ï¼š
- `_get_company_info()`
- `_get_profit_sheet()`
- `_get_balance_sheet()`
- `_get_cashflow_sheet()`
- `_get_financial_indicators()`
- `_get_valuation_indicators()`
- `_get_earnings_forecast()`

#### TushareProvider æ‰©å±•
åœ¨ `tradingagents/data_sources/tushare_provider.py` ä¸­æ·»åŠ ä»¥ä¸‹æ–¹æ³•ï¼ˆä½œä¸º fallbackï¼‰ï¼š
- `get_company_info()`ï¼ˆå·²æœ‰ `get_stock_basic`ï¼Œå¯å¤ç”¨ï¼‰
- `get_income()`
- `get_balancesheet()`
- `get_cashflow()`
- `get_fina_indicator()`
- `get_daily_basic()`
- `get_forecast()`
- `get_express()`

### Tools å±‚å®ç°

åœ¨ `tradingagents/tools/fundamentals_tools.py` ä¸­å®ç° 5 ä¸ªå·¥å…·ï¼š
1. `get_company_info`
2. `get_financial_statements`
3. `get_financial_indicators`
4. `get_valuation_indicators`
5. `get_earnings_data`

æ¯ä¸ªå·¥å…·éƒ½å®ç° AkShare ä¼˜å…ˆã€Tushare Fallback çš„ç­–ç•¥ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®æ ¼å¼ç»Ÿä¸€**: AkShare å’Œ Tushare è¿”å›çš„æ•°æ®æ ¼å¼å¯èƒ½ä¸åŒï¼Œéœ€è¦ç»Ÿä¸€å¤„ç†
2. **é”™è¯¯å¤„ç†**: å•ä¸ªæ•°æ®æºå¤±è´¥æ—¶ï¼Œåº”è‡ªåŠ¨ fallback åˆ°å¦ä¸€ä¸ªæ•°æ®æº
3. **æ•°æ®æ¸…æ´—**: æ³¨æ„å¤„ç†ç¼ºå¤±å€¼ã€æ•°æ®ç±»å‹è½¬æ¢ç­‰
4. **æ€§èƒ½ä¼˜åŒ–**: è€ƒè™‘ç¼“å­˜æœºåˆ¶ï¼Œé¿å…é‡å¤è°ƒç”¨
5. **è¿”å›æ ¼å¼**: ç»Ÿä¸€è¿”å› JSON æ ¼å¼ï¼Œä¾¿äº Agent å¤„ç†

---

## âœ… å¾…ç¡®è®¤äº‹é¡¹

1. **å·¥å…·ç²’åº¦**: æ˜¯å¦å°†ä¸‰å¤§è´¢åŠ¡æŠ¥è¡¨åˆå¹¶ä¸ºä¸€ä¸ªå·¥å…· `get_financial_statements`ï¼Œè¿˜æ˜¯æ‹†åˆ†ä¸ºä¸‰ä¸ªç‹¬ç«‹å·¥å…·ï¼Ÿ
2. **æ•°æ®èŒƒå›´**: é»˜è®¤è·å–æœ€è¿‘ 4 æœŸæ•°æ®æ˜¯å¦åˆé€‚ï¼Ÿæ˜¯å¦éœ€è¦æ”¯æŒè‡ªå®šä¹‰æ—¶é—´èŒƒå›´ï¼Ÿ
3. **è¡Œä¸šå¯¹æ¯”**: æ˜¯å¦éœ€è¦æ·»åŠ è¡Œä¸šå¯¹æ¯”åŠŸèƒ½ï¼ˆå¦‚ä¸åŒè¡Œä¸šå¹³å‡ PEã€ROE å¯¹æ¯”ï¼‰ï¼Ÿ
4. **è¿”å›æ ¼å¼**: æ˜¯å¦ç»Ÿä¸€è¿”å› JSONï¼Œè¿˜æ˜¯éƒ¨åˆ†è¿”å› Markdownï¼ˆç±»ä¼¼ `AkshareProvider.get_global_news()`ï¼‰ï¼Ÿ

---

**è°ƒæŸ¥å®Œæˆæ—¶é—´**: 2025-12-12  
**è°ƒæŸ¥å·¥å…·**: `detailed_fundamentals_investigation.py`

